<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="icon.ico">
    <title>Goofy Mania</title>
    <link rel="stylesheet" href="./main.css">
    <script src="./main.js" defer></script>
    <script src="./Game.js"></script>
</head>

<body>
    <div style="position: absolute; display: flex; justify-content: center; align-items: center; font-size: 3em; width: 100%; height: 100%;" id="loading-text"></div>
    <div style="position: absolute; top: 20px; left: 20px; color: red;">GOOFY MANIA<br>V2.0000000001 ALPHA<br>PART OF MULTIPACK NOT TO BE SOLD SEPERATELY<br><div style="text-decoration: line-through; color: red;">FEATURING NON-FUNCTIONAL SLIDERS</div>FEATURING BROKEN ACCURACY</div>
    <div id="fps" style="position: absolute; bottom: 20px; left: 20px; color: red;">FPS: ---</div>
    <div id="map-select" style="display: none; width: 100%; z-index: 1;">
        <h1 style="display: flex; justify-content: center; margin-top: 50px;">Map select</h1>
        <div id="maps"></div>
    </div>
    <div id="level-select" style="display: none; width: 100%; z-index: 1;">
        <h1 style="display: flex; justify-content: center; margin-top: 50px;">Level select</h1>
        <div id="levels"></div>
    </div>
    <div style="display: flex; position: absolute; justify-content: center; align-items: center; width: 100%; height: 100%">
        <div id="game" style="display: none; max-width: 100vw; max-height: 100vh; width: 1280px; height: 720px; resize: both;"></div>
    </div>
    <!-- <button id="button" style="width: 100%; height: 100%; font-size: 5em; background-color: black; color: white;" onclick="start()"></button> -->
    <!-- <div id="game"></div> -->

    <!-- <script>
        game = null;

        (async () => {
            const gameElement = document.getElementById("game");

            const fps = document.getElementById("fps");

            document.getElementById("button").innerHTML = "LOADING SKIN";
            const skin = await getSkinData("skins/default");
            loadDefaultSkin(skin);

            let mapPath;
            let levelIndex;

            // mapPath = `maps\\Quaver - coltrane - this train going nowhere - 186409`;
            // levelIndex = 0;
            mapPath = `maps\\Quaver - xi - Blue Zenith - 389069`;
            levelIndex = 8;
            // mapPath = `maps\\Quaver - Drake feat. Lil Durk - Laugh Now Cry Later (Cut Ver.) - 571400`;
            // levelIndex = 0;
            // mapPath = `maps\\Quaver - dive to the heart - the music of the future - 155593`;
            // levelIndex = 3;
            // mapPath = `maps\\Quaver - Ludicin - Clinozoisite - 139141`;
            // mapPath = `maps\\Quaver - Ludicin - Everlasting Eternity - 162225`;
            // levelIndex = 0;
            // mapPath = `maps\\Quaver - 31444`;
            // mapPath = `maps\\Quaver - 31111`;
            // mapPath = `maps\\Quaver - Ludicin - Everlasting Eternity - 149702`;
            // mapPath = `maps\\Quaver - 29264`;
            // mapPath = `maps\\Quaver - 28959`;
            // mapPath = `maps\\Quaver - Slax - Bimbo Limbo - 755947`;
            // mapPath = `maps\\Quaver - Morimori Atsushi - Funkotsu Saishin Casino - 26241`;
            // levelIndex = 1;
            // mapPath = `maps\\Quaver - Chroma - I - 51373`;
            // levelIndex = 6;
            // levelIndex = 2;
            // mapPath = `maps\\Quaver - Kobaryo - Endless Adventure - 208693`;
            // mapPath = `maps\\Quaver - Laur - Animosity - 104939`;
            // levelIndex = 2;
            // mapPath = `maps\\test`;

            document.getElementById("button").innerHTML = "GETTING MAP DATA";
            map = await getMapData(mapPath);
            document.getElementById("button").innerHTML = "GETTING LEVEL DATA";
            level = await getLevelData(mapPath, map.levels[levelIndex]);

            const user = {
                settings: {
                    // scrollSpeed: 10,
                    scrollSpeed: 40,
                    masterVolume: 15,
                    musicVolume: 100,
                    sfxVolume: 100,
                    // musicVolume: 10,

                    keybinds: {
                        "4-keys": "dfjk".split(""),
                        "7-keys": "sdf jkl".split("")
                    }
                },
                modifiers: {
                    auto: true,
                    speed: 1.2,
                    pitch: true,
                    // noSliders: true,
                },
                skin
            }

            game = new Game(gameElement, map, level, user);
            game.init();

            document.getElementById("button").innerHTML = "CLICK ME TO START"

        })();
        function start() {
            if (!game) return;
            game.once("onStart", () => document.getElementById("button").remove());
            game.start();
            game.once("onStopping", () => location.reload());
            game.on("onFpsUpdate", i => fps.innerHTML = `FPS: ${i}`);
        }

        async function changeMapTest(mapName, levelIndex = 0) {
            const map = await getMapData(`maps\\${mapName}`)
            const level = await getLevelData(`maps\\${mapName}`, map.levels[levelIndex])
            
            game.onStopping = null;
            game.once("onGameLoopStop", () => {
                game.map = map;
                game.level = level;
                game.init();
                game.start();
            });
            game.stop();
        }
    </script> -->
</body>

</html>